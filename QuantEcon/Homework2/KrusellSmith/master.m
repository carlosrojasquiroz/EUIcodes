clc,close,clear;
%---------------------------------------------------------------------------------------------------------------------------
%% Aiyagari model with aggregate shocks
%---------------------------------------------------------------------------------------------------------------------------
% This code solves the Aiyagari model with aggregate shocks by the K-S method.
%---------------------------------------------------------------------------------------------------------------------------
%% 1. Parameters
%---------------------------------------------------------------------------------------------------------------------------
p=parameters();
%---------------------------------------------------------------------------------------------------------------------------
%% 2. Matrices (grid specifications, transition probabilities, etc.)
%---------------------------------------------------------------------------------------------------------------------------
m=matrices(p);
%---------------------------------------------------------------------------------------------------------------------------
%% 3. Optimal policy functions
%---------------------------------------------------------------------------------------------------------------------------
[r.g_a,r.g_c]=egm_i(p,m,m.B,m.g_a);

s=solveKS(p,m);






figure()
plot(m.a_grid,g_a(1,:,1,3))
hold on
plot(m.a_grid,g_a(1,:,2,3))

figure()
plot(m.a_grid,g_a(2,:,1,3))
hold on
plot(m.a_grid,g_a(2,:,2,3))

% Primer set de resultados: B

 0.173782188124377   0.911198220560113   0.184770544076830   0.908070112864729