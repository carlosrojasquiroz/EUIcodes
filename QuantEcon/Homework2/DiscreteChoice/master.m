clc,close,clear;
%---------------------------------------------------------------------------------------------------------------------------
%% SIM with discrete choice
%---------------------------------------------------------------------------------------------------------------------------
% This code solves the standard incomplete markets model (SIM) with discrete
% choice (working or not) and extreme value shocks by VFI algorithm. 
% The current version of the model doesn't have idiosyncratic shocks. 
%---------------------------------------------------------------------------------------------------------------------------
%% 1. Parameters
%---------------------------------------------------------------------------------------------------------------------------
        p=parameters();
%---------------------------------------------------------------------------------------------------------------------------
%% 2. Matrices (grid specification for assets)
%---------------------------------------------------------------------------------------------------------------------------
        m=matrices(p);
%---------------------------------------------------------------------------------------------------------------------------
%% 3. Individual Policy and value functions
%---------------------------------------------------------------------------------------------------------------------------
        % Standard incomplete market
        p.phi=0; p.evind=0; 
        s0=vfi(p,m);
        % Discrete choice
        p.phi=0.75; p.evind=0; 
        s1=vfi(p,m);
        % Discrete choice + extreme value shocks
        p.phi=0.75; p.evind=1; 
        s2=vfi(p,m);        
%---------------------------------------------------------------------------------------------------------------------------
%% 4. Graphs
%---------------------------------------------------------------------------------------------------------------------------
        graphs(p,m,s1,s2)
%---------------------------------------------------------------------------------------------------------------------------
                                    % (c) Carlos Rojas Quiroz - December 2022