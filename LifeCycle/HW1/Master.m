clear,clc,close;
%-------------------------------------------------------------------------------------------
% Parameters
%-------------------------------------------------------------------------------------------
run parameters.m
%-------------------------------------------------------------------------------------------
% Grids
%-------------------------------------------------------------------------------------------
run grids.m
%-------------------------------------------------------------------------------------------
% Invariant distribution
%-------------------------------------------------------------------------------------------
m.muJ=invdist(p.nzz,m.Pz);
%-------------------------------------------------------------------------------------------
% Ages distribution
%-------------------------------------------------------------------------------------------
m.Sj=readmatrix('LifeTables.txt');
[p.J,m.Psi]=ages(p,m);
%-------------------------------------------------------------------------------------------
% Effort and labor
%-------------------------------------------------------------------------------------------
[m.e,p.L]=labor(p,m);
%-------------------------------------------------------------------------------------------
% Firms
%-------------------------------------------------------------------------------------------
[p.K,p.w]=firms(p);
%-------------------------------------------------------------------------------------------
% Fiscal policy
%-------------------------------------------------------------------------------------------
[p.theta,m.b]=fiscal(p,m);
%-------------------------------------------------------------------------------------------
% Policy functions: endogenous grid method
%-------------------------------------------------------------------------------------------
[r.V, r.g_a, r.g_c,r.g_e] = egm(p,m);
%-------------------------------------------------------------------------------------------
% Euler equation errors
%-------------------------------------------------------------------------------------------
r. EE=eulererrors(r.g_a,p,m);
%-------------------------------------------------------------------------------------------
% Solving the model
%-------------------------------------------------------------------------------------------
[r.Tg_agg,r.K_agg,r.rg_eq,r.w_eq,r.theta_eq,r.b_eq,r.K_Y_agg,r.dist,r.g_aF,r.g_eF,r.g_cF]=solve_hugget(p,m);
%-------------------------------------------------------------------------------------------
% Distribution of assets
%-------------------------------------------------------------------------------------------
[r.Assets_dist, r.Assets_stats,r.Earnings_stats, r.Consumption_stats, r.Assets_dist_ages]=distribution(m,p,r);
%-------------------------------------------------------------------------------------------
% Gini and Lorenz curve
%-------------------------------------------------------------------------------------------
[r.gini_index,r.lorenz] = gini(r.Assets_dist,m.a_grid);
%-------------------------------------------------------------------------------------------
% Graphs
%-------------------------------------------------------------------------------------------
run graphs.m
